doctype html
html(lang='en')
  head
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous")
    script(src="https://code.jquery.com/jquery-3.5.1.slim.min.js", integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj", crossorigin="anonymous")
    script(src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js", integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV", crossorigin="anonymous")
    link(rel='stylesheet', href='/stylesheets/style.css')

  body
    div(class='container-fluid px-2')
      div(class="row mt-3")
        div(class="col-sm-2")
          form(class="form-inline my-2 my-lg-0")
            select#subject(class='form-control selcls', type='select', name='subject' required='true', class="form-control form-control-sm" onchange="ChangeSelection(this);")
              option(value=1) &lt;search all&gt;
              for subject in subject_list
                if subjectid
                  option(value=subject._id selected=(subject._id.toString()===subjectid.toString() ? 'selected' : false) ) #{subject.title}
                else 
                  option(value=subject._id) #{subject.title}
            select#topic(class='form-control selcls', type='select', name='topic' required='true', class="form-control form-control-sm" onchange="ChangeSelection(this);")
              option(value=1) &lt;search all&gt;
              for topic in topic_list
                if topicid
                  option(value=topic._id selected=(topic._id.toString()===topicid.toString() ? 'selected' : false) ) #{topic.title}
                else 
                  option(value=topic._id) #{topic.title}
            select#subtopic(class='form-control selcls', type='select', name='subtopic' required='true', class="form-control form-control-sm" onchange="ChangeSelection(this);")
              option(value=1) &lt;search all&gt;
              for subtopic in subtopic_list
                if subtopicid
                  option(value=subtopic._id selected=(subtopic._id.toString()===subtopicid.toString() ? 'selected' : false) ) #{subtopic.title}
                else 
                  option(value=subtopic._id) #{subtopic.title}
            script.
              function ChangeSelection(element) {
                subject_element = document.getElementById('subject');
                topic_element = document.getElementById('topic');
                subtopic_element = document.getElementById('subtopic');
                subject_selected_index = subject_element.selectedIndex;
                topic_selected_index = topic_element.selectedIndex;
                subtopic_selected_index = subtopic_element.selectedIndex;
                subjectid = subject_element.options[subject_selected_index].value;
                topicid = topic_element.options[topic_selected_index].value;
                subtopicid = subtopic_element.options[subtopic_selected_index].value
                if (element.name === 'subject') {
                  if (subjectid == 1) {
                    // <search all> selected in subject so set
                    // topic and subtopic to be the same
                    topicid = 1;
                    subtopicid = 1;
                  } else {
                    topicid = 0;
                    subtopicid = 0;
                  }
                }
                if (element.name === 'topic') {
                  if (topicid == 1) {
                    // <search all> selected in topic so set
                    // subtopic to be the same
                    subtopicid = 1;
                  } else {
                    subtopicid = 0;
                  }
                }
                //alert('subjectid ' + subjectid + ' topicid ' + topicid + ' subtopicid ' + subtopicid);
                window.location.href = '/repo/' + subjectid + '/' + topicid + '/' + subtopicid + '/notes';
              }
          div(class="row gx-0")
            div(class="col-sm-12")
            nav(class="navbar navbar-expand-lg navbar-light bg-light")
              ul(class="navbar-nav mr-auto")
                li(class="nav-item active")
                  a(class="nav-link dropdown-toggle" href="#description" id="navbarDropdownDescription" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false") Description
                    div(class="dropdown-menu text-wrap" aria-labelledby="navbarDropdownDescription" style="width: 16rem;")
                      p(class="text-justify") #{subtopic_description} 
                li(class="nav-item dropdown")
                  a(class="nav-link dropdown-toggle" href="#links" id="navbarDropdownLinks" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false") Links
                  div(class="dropdown-menu" aria-labelledby="navbarDropdownLinks")
                    p Subject material
                    if subject_name === 'Biology'
                      a(class="dropdown-item" href='https://www.aqa.org.uk/subjects/science/as-and-a-level/biology-7401-7402/changes-for-2021' target='_blank' role='button') A-level Specification
                      a(class="dropdown-item" href='https://guildfordcounty.s3.amazonaws.com/uploads/document/Biology-Handbook.pdf?t=1630671756?ts=1630671756' target='_blank' role='button') Handbook
                    if subject_name === 'Chemistry'
                      a(class="dropdown-item" href='https://www.aqa.org.uk/subjects/science/as-and-a-level/chemistry-7404-7405/changes-for-2021' target='_blank' role='button') A-level Specification
                      a(class="dropdown-item" href='https://guildfordcounty.s3.amazonaws.com/uploads/document/Chemistry-handbook.pdf?t=1630671756?ts=1630671756' target='_blank' role='button') Handbook
                      a(class="dropdown-item" href='https://www.thegeoexchange.org/chemistry/naming/resources/common_ion_table.php' target='_blank' role='button') Common ion table
                      a(class="dropdown-item" href='https://www.technologyuk.net/science/matter/electron-shells-and-orbitals.shtml' target='_blank' role='button') Electron shells and orbitals
                      a(class="dropdown-item" href='https://www.eiu.edu/eiuchem/forms/tutorial2.pdf' target='_blank' role='button') Formulas
                      a(class="dropdown-item" href='https://chemed.chem.purdue.edu/genchem/topicreview/bp/ch2/names.html' target='_blank' role='button') Nomenclature
                    if subject_name === 'Geography'
                      a(class="dropdown-item" href='https://www.aqa.org.uk/subjects/geography/as-and-a-level/geography-7037/specification-at-a-glance' target='_blank' role='button') A-level Specification
                      a(class="dropdown-item" href='https://guildfordcounty.s3.amazonaws.com/uploads/document/A-Level-Handbook-Geography-2021.pdf?t=1630671756?ts=1630671756' target='_blank' role='button') Handbook
                    div(class="dropdown-divider")
                    p Maths
                    a(class="dropdown-item" href='https://www.rapidtables.com/math/symbols/Basic_Math_Symbols.html' target='_blank' role='button') Maths Symbols
                    a(class="dropdown-item" href='https://mathworld.wolfram.com/' target='_blank' role='button') Wolfram
                    div(class="dropdown-divider")
                    p  General
                    a(class="dropdown-item" href='https://www.guildfordcounty.co.uk/603/welcome-to-the-sixth-form' target='_blank' role='button') GCS Sixth Form
          div(class="row gx-0")
            if (subjectid != '1' && topicid != '1' && subtopicid != '1')
              a(class='btn btn-primary btn-sm btn-block' href='/repo/' + subjectid + '/' + topicid + '/' + subtopicid + '/note/create' role='button') Create New Note
        div(class="col-sm-10" id='form-div')
          block content